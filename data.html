<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/css/bootstrap.min.css">

    <!-- jQuery library -->
    <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.4/dist/jquery.slim.min.js"></script>

    <!-- Popper JS -->
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js"></script>

    <!-- Latest compiled JavaScript -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/js/bootstrap.bundle.min.js"></script>
    <script src="navbar.js"></script>
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/css/select2.min.css" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/select2-bootstrap-5-theme@1.3.0/dist/select2-bootstrap-5-theme.min.css" />

    <script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/js/select2.min.js"></script>

    <script src="logincheck.js"></script>
    <script>
      allowedToView(window.location.pathname).then(response => {
        if(!response) {
          location.href = "/index.html?accessdenied"
        }
      })
    </script>

    <script>
        window.onload=function(){
        tekenmenu();
        letsgo();
    }
    </script>
  <!-- <style>
    .select2-container--bootstrap .select2-selection {
      background-color: blue;
    }
  </style> -->
</head>
<body>
     <!-- A grey horizontal navbar that becomes vertical on small screens -->
<div id="menu"></div> 

  


<!-- <div class="form-group">
  <label for="sel1">Select list (select one):</label>
  <select class="form-control" id="sex">
    <option value="F">Vrouw</option>
    <option value="M">Man</option>
    
  </select>
</div>  -->

<!-- <select id="country">
  <option value="UK">United Kingdom</option>
  <option value="DE">Germany</option>
  <option value="FR">Frankrijk</option>
  <option value="NL">Nederland</option>
</select>
<br> -->




<!-- <div class="container">
  <h2>Form control: radio buttons</h2>
  <p>The form below contains three radio buttons. The last option is disabled:</p>
  <form>
    <div class="radio">
      <label><input type="radio" name="optradio" id="F" >Vrouw</label>
    </div>
    <div class="radio">
      <label><input type="radio" name="optradio" id="M">Man</label>
    </div>
      </form>
</div> -->



      

      <!-- <button onclick="letsgo()">Klik hier</button> -->
      
      
     
      
      

      <div class="container">
        <div class="row">
            <!-- First Column -->
            
            <div class="col-md-2">
                <!-- Content for the first column goes here -->
                <br>
                <br>
                <br>
                <br>
                <h2><b>Filter</b></h2>
                <br>
                <!-- <br> -->
                <!-- <p>This is the content of the first column.</p> -->
                <div class="form-group">
                  <label for="sel1"><b>Land</b></label>
                  

                  <select class="form-control" id="country" multiple><option value="AT">Oostenrijk</option><option value="BE">België</option><option value="BG">Bulgarije</option><option value="CH">Zwitserland</option><option value="CY">Cyprus</option><option value="CZ">Tsjechië</option><option value="DE">Duitsland</option><option value="DK">Denemarken</option><option value="EA19">Euro Area 19</option><option value="EA20">Euro Area 20</option><option value="EE">Estland</option><option value="EL">Griekenland</option><option value="ES">Spanje</option><option value="EU15">EU15</option><option value="EU27_2020">EU27_2020</option><option value="EU28">EU28</option><option value="FI">Finland</option><option value="FR">Frankrijk</option><option value="FX">Frankrijk (Metropolitan)</option><option value="HR">Kroatië</option><option value="HU">Hongarije</option><option value="IE">Ierland</option><option value="IS">IJsland</option><option value="IT">Italië</option><option value="LT">Litouwen</option><option value="LU">Luxemburg</option><option value="LV">Letland</option><option value="ME">Montenegro</option><option value="MK">Noord-Macedonië</option><option value="MT">Malta</option><option value="NL">Nederland</option><option value="NO">Noorwegen</option><option value="PL">Polen</option><option value="PT">Portugal</option><option value="RO">Roemenië</option><option value="RS">Servië</option><option value="SE">Zweden</option><option value="SI">Slovenië</option><option value="SK">Slowakije</option><option value="TR">Turkije</option><option value="UK">Verenigd Koninkrijk</option></select>
               

                 
                </div>
                <br>
                <div class="form-group">

                <label for="sel2"><b>Geslacht</b></label>

                <select class="form-control" id="sex">
                  <option value="F">Vrouw</option>
                  <option value="M">Man</option>
                 
                </select> 
                </div>
                <br>
                <button type="button" class="btn btn-primary" onclick="letsgo()">Update</button>
  
     


            </div>
            <div class="col-md-2"></div>
    
            <!-- Second Column -->
            <div class="col-md-7">
                <!-- Content for the second column goes here -->
                <!-- <h2>Second Column</h2> -->
                <!-- <p>This is the content of the second column.</p> -->
                <div id="myChart"></div>
            </div>
        </div>
    </div>

  <!-- <div class="row">
    <div class="col-lg-4 text-center"><button type="button" class="btn btn-secondary custombutton">Vacatures</button></div>
    <div class="col-lg-4 text-center"><button type="button" class="btn btn-secondary custombutton">CVs</button></div>
    <div class="col-lg-4 text-center"><button type="button" class="btn btn-secondary custombutton">Profiel</button></div>
  </div> -->

  <style>
    .custombutton {
        width:200px;
        aspect-ratio: 1;
    }
    
   
  </style>
  
    
    

  <link rel="stylesheet" type="text/css" href="styles.css">
  <script>
    // $( '#country' ).select2( {
    // theme: 'bootstrap-5'
// } );
$(document).ready(function() {
    $('#country').select2({
      theme: 'bootstrap-5',
      // templateSelection: function(data) {
        // Increase font size of selected option
        // return $('<span style="font-size: 18px;">' + data.text + '</span>');
      // },
      // templateResult: function(data) {
        // Increase font size of dropdown options
        // return $('<span style="font-size: 18px;">' + data.text + '</span>');
      // }
    });
  });
        function letsgo() {
          var selectedCountries = Array.from(document.querySelectorAll('#country option:checked')).map(option => option.value);
          var sex = document.getElementById("sex").value;
          // var selectedCountriesString = selectedCountries.join(',');
          // fetch("http://127.0.0.1:5000/jefta/" + countryCode)        
          // fetch(`http://127.0.0.1:5000/filterdata?country=${country}&sex=${sex}`)
          // fetch(`http://20.76.64.179:5000//filterdata?country=${country}&sex=${sex}`)
          // fetch(`http://20.76.64.179:5000//filterdata?country=${selectedCountriesString}&sex=${sex}`)
          // fetch(`http://127.0.0.1:5000//filterdata?country=${selectedCountriesString}&sex=${sex}`)
          fetch(`http://127.0.0.1:5000//filterdata?countries=${JSON.stringify(selectedCountries)}&sex=${sex}`)
            // fetch(`http://20.76.64.179:5000/filterdata?country=
            .then(r => r.json())
            .then(d => verwerkgegevens(d, selectedCountries));
        }
      
        function verwerkgegevens(data, selectedCountries) {
          var traces = [];

for (var i = 0; i < selectedCountries.length; i++) {
    var countryData = data.filter(d => d.geo === selectedCountries[i]);

    var OBS_VALUES = countryData.map(d => d.OBS_VALUE);
    var TIME_PERIODS = countryData.map(d => d.TIME_PERIOD);

    var trace = {
        x: TIME_PERIODS,
        y: OBS_VALUES,
        mode: 'lines+markers',
        line: {
            shape: 'spline'
        },
        name: selectedCountries[i] // Use country code as the trace name
    };

    traces.push(trace);
}

var layout = {
    xaxis: {
        title: 'Year',
        titlefont: {
            size: 20,
        },
        autorange: false,
        range: [1993, 2020],
    },
    yaxis: {
        title: 'Labor Participation (%)',
        titlefont: {
            size: 20,
        },
        autorange: false,
        range: [10, 80],
    },
    width: 1000,
    height: 700,
    margin: {
        t: 40,
        r: 20,
        b: 50,
        l: 50
    }
};

Plotly.newPlot('myChart', traces, layout);
}
</script>
</body>
</html>