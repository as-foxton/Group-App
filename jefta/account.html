<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Account</title>
    <!-- Latest compiled and minified CSS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/css/bootstrap.min.css">

    <!-- jQuery library -->
    <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.4/dist/jquery.slim.min.js"></script>

    <!-- Popper JS -->
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js"></script>

    <!-- Latest compiled JavaScript -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/js/bootstrap.bundle.min.js"></script>
    <script src="navbar.js"></script>
    <script>
        window.onload = tekenmenu;
    </script>
    <script>
        function letsgo() {

            var xhr = new XMLHttpRequest();
            xhr.onreadystatechange = function () {
                if (this.readyState == 4) {
                    console.log(this.responseText);
                    var allAccounts = JSON.parse(this.responseText);
                    var eindString = "<table class= 'table mt-5'><thead><tr><th>Naam</th><th>Rol</th><th>Email</th><th>Wachtwoord</th><th>Bedrijf</th><th>Locatie</th><th>Edit</th><th>Delete</th></tr></thead>";

                    for (var x = 0; x < allAccounts.length; x++) {
                        eindString += "<tbody><tr><td>" + allAccounts[x].naam + "</td><td>" + allAccounts[x].rol + "</td><td>" + allAccounts[x].email + "</td><td>" + allAccounts[x].wachtwoord + "</td><td>" + allAccounts[x].bedrijf + "</td><td>" + allAccounts[x].locatie + "<td><button class= 'btn btn-secondary' onclick=sendTo(" + allAccounts[x].persoons_nr + ")>Edit</button></td><td><button class= 'btn btn-danger' onclick=verwijderen(" + allAccounts[x].persoons_nr + ")>Delete</button></td></tr></tbody>";

                    }
                    eindString += "</table>"
                    document.getElementById("alleAccountsTabel").innerHTML = eindString;
                }

            }
            xhr.open("GET", backendurl + "/account/all", true);
            xhr.send()

        }
        function toevoegen() {
            var hetAccount = {};
            hetAccount.naam = document.getElementById("naamGebruiker").value;
            hetAccount.rol = document.getElementById("rolGebruiker").value;
            hetAccount.email = document.getElementById("emailGebruiker").value;
            hetAccount.wachtwoord = document.getElementById("wachtwoordGebruiker").value;
            hetAccount.bedrijf = document.getElementById("bedrijfGebruiker").value;
            hetAccount.locatie = document.getElementById("locatieGebruiker").value;
            var deJSON = JSON.stringify(hetAccount);
            var xhr = new XMLHttpRequest();
            xhr.onreadystatechange = function () {
                if (this.readyState == 4) {
                    console.log("toevoegen gelukt");
                    letsgo();
                }

            }
            xhr.open("POST", backendurl + "/account/create", true);
            xhr.setRequestHeader("Content-Type", "application/json");
            xhr.send(deJSON);


        }
        function verwijderen(persoons_nr) {

            var xhr = new XMLHttpRequest();
            xhr.onreadystatechange = function () {
                if (this.readyState == 4) {
                    console.log("verwijderen gelukt " + persoons_nr);
                    letsgo();
                }

            }
            xhr.open("GET", backendurl + "/account/delete/" + persoons_nr, true);
            xhr.send()


        }
        function sendTo(persoons_nr) {

            var xhr = new XMLHttpRequest();
            xhr.onreadystatechange = function () {
                if (this.readyState == 4) {
                    var theAccount = JSON.parse(this.responseText);
                    console.log(theAccount);
                    document.getElementById("naamGebruiker").value = theAccount.naam;
                    document.getElementById("rolGebruiker").value = theAccount.rol;
                    document.getElementById("emailGebruiker").value = theAccount.email;
                    document.getElementById("wachtwoordGebruiker").value = theAccount.wachtwoord;
                    document.getElementById("bedrijfGebruiker").value = theAccount.bedrijf;
                    document.getElementById("locatieGebruiker").value = theAccount.locatie;
                    var buttonAanroep = "<div><button onclick=aanpassen(" + persoons_nr + ") >Update</button></div>";
                    document.getElementById("updatebutton").innerHTML = buttonAanroep;
                }

            }
            xhr.open("GET", backendurl + "/account/" + persoons_nr, true);
            xhr.send()

        }
        function aanpassen(persoons_nr) {
            var hetAccount = {};
            hetAccount.naam = document.getElementById("naamGebruiker").value;
            hetAccount.rol = document.getElementById("rolGebruiker").value;
            hetAccount.email = document.getElementById("emailGebruiker").value;
            hetAccount.wachtwoord = document.getElementById("wachtwoordGebruiker").value;
            hetAccount.bedrijf = document.getElementById("bedrijfGebruiker").value;
            hetAccount.locatie = document.getElementById("locatieGebruiker").value;
            var deJSON = JSON.stringify(hetAccount);

            var xhr = new XMLHttpRequest();
            xhr.onreadystatechange = function () {
                if (this.readyState == 4) {
                    console.log("editen gelukt" + persoons_nr);
                    letsgo();
                }

            }
            xhr.open("PUT", backendurl + "/account/update/" + persoons_nr, true);
            xhr.setRequestHeader("Content-Type", "application/json");
            xhr.send(deJSON);

        }

    </script>
</head>

<body>
    <nav class="navbar navbar-expand-sm bg-light justify-content-center customnavbar" id="menu">



    </nav>
    <div class="container-fluid px-3">
        <div class="row">
            <div class="col-3">

                <div class="form-group">
                    <label for="naamGebruiker">Naam:</label>
                    <input type="text" class="form-control" id="naamGebruiker">
                </div>
            </div>

        </div>
        <div class="row">
            <div class="col-3">
                <div class="form-group">
                    <label for="rolGebruiker">Rol: </label>
                    <input type="text" class="form-control" id="rolGebruiker">
                </div>

            </div>
        </div>
        <div class="row">
            <div class="col-3">
                <div class="form-group">
                    <label for="emailGebruiker">Emailadres: </label>
                    <input type="text" class="form-control" id="emailGebruiker">
                </div>
            </div>
        </div>
        <div class="row">
            <div class="col-3">
                <div class="form-group">
                    <label for="wachtwoordGebruiker">Wachtwoord: </label>
                    <input type="password" class="form-control" id="wachtwoordGebruiker">
                </div>

            </div>
        </div>
        <div class="row">
            <div class="col-3">

                <div class="form-group">
                    <label for="bedrijfGebruiker">Bedrijf: </label>
                    <input type="text" class="form-control" id="bedrijfGebruiker">
                </div>
            </div>
        </div>
        <div class="row">
            <div class="col-3">
                <div class="form-group">
                    <label for="locatieGebruiker">Locatie: </label>
                    <input type="text" class="form-control" id="locatieGebruiker">
                </div>

            </div>
        </div>
        <div class="row">
            <div class="col-3">

                <div><button type="button" class="btn btn-secondary btn-block mt-5" onclick="toevoegen()">Voeg toe</button></div>
            </div>
        </div>
        <div class="row">
            <div class="col-3">

                <div><button type="button" class="btn btn-secondary btn-block mt-5" onclick="letsgo()">Toon alle accounts</button>
                </div>
            </div>
        </div>
        <div class="row">
            <div class="col-3">
                <div id="updatebutton"></div>

            </div>
        </div>
        <div class="row">
            <div class="col-3">
                <div id="alleAccountsTabel"></div>

            </div>
        </div>
    </div>


</body>

</html>